# Обнаружение вредоносных файлов с использованием машинного обучения

Этот проект направлен на разработку системы машинного обучения, которая предсказывает, является ли исполняемый файл зловредным на основе статически импортированных библиотек. 
Решение включает скрипты для обучения модели [train.py](https://github.com/giblyf/anti_virus_catboost_model/blob/main/src/train.py), оценки ее производительности [validate.py](https://github.com/giblyf/anti_virus_catboost_model/blob/main/src/validate.py) и прогнозирования на тестовом наборе [predict.py](https://github.com/giblyf/anti_virus_catboost_model/blob/main/src/predict.py). 


## Задание 
Разработать систему машинного обучения, которая по списку статически импортируемых библиотек exe файла предсказывает, является ли этот файл зловредным.   
Для выполнения задания предоставляются три выборки: обучающая, валидационная и проверочная. Выборки представлены в виде tsv файлов с тремя колонками:  
- **is_virus** – является ли файл зловредным: 1 = да, 0 = нет   
- **filename** – имя файла для ознакомления;   
- **libs** – через запятую перечисление библиотек, статически импортируемых этим файлом (мы использовали библиотеку LIEF для получения списка).
## Данные   
- На обучающей выборке – [train.tsv](https://github.com/giblyf/anti_virus_catboost_model/blob/main/data/train.tsv) – следует обучать модель машинного обучения.  
- На валидационной выборке – [val.tsv](https://github.com/giblyf/anti_virus_catboost_model/blob/main/data/val.tsv) – требуется подсчитать, насколько хорошо модель справляется с файлами, которые она не видела при обучении.
Характеристики требуется записать в текстовый файл validation.txt со следующим содержанием (изменив значения на ваши):  
True positive: 2  
False positive: 20  
False negative: 18  
True negative: 60  
Accuracy: 0.6200  
Precision: 0.0909  
Recall: 0.1000  
F1: 0.0952  
- Проверочная выборка – [test.tsv](https://github.com/giblyf/anti_virus_catboost_model/blob/main/data/test.tsv) – содержит только колонку libs. Для проверочной выборки требуется создать файл prediction.txt, в котором для каждой строки файла проверочной выборки будет содержаться один символ: либо 1 если модель предсказывает этот файл как зловредный, либо 0 иначе. Первая строка файла, соответствующая заголовку проверочной выборки должна быть “prediction”:
prediction
0
0
1
( … много строк пропущено … )
0
1
0


### Дополнительное задание:
Для проверочной выборки создайте ещё один файл, explain.txt, где для каждой строки файла проверочной выборки будет содержаться причина (в свободном человеко-читаемом формате) по которой модель посчитала этот файл зловредным. Строки для не зловредных файлов должны быть пустыми


## Структура проекта

- data/
  - train.tsv
  - val.tsv
  - test.tsv
- models/
  - model.pkl
- results/
  - validation.txt
  - prediction.txt
  - explain.txt
- src/
  - train.py
  - validate.py
  - predict.py
- README.md
- requirements.txt


## Скрипты

- train.py: Обучает модель машинного обучения с использованием обучающего набора данных (data/train.tsv) и сохраняет модель в файл models/anti_virus_detector.cmb.
- validate.py: Проверяет обученную модель на валидационном наборе данных (data/val.tsv) и генерирует метрики производительности, сохраняя их в results/validation.txt.
- predict.py: Использует обученную модель для предсказания, являются ли файлы в тестовом наборе (data/test.tsv) зловредными. Прогнозы сохраняются в results/prediction.txt.
explain.py (опционально): Предоставляет объяснения для предсказаний на тестовом наборе и сохраняет их в results/explain.txt.


## Как запустить  
Клонируйте репозиторий:  
```
git clone https://github.com/giblyf/anti_virus_catboost_model.git
anti_virus_catboost_model
```
Установите необходимые библиотеки:  
```
pip install -r requirements.txt
```
Запустите скрипты в следующем порядке:  
```
python src/train.py
python src/validate.py
python src/predict.py
```

## Дополнительные замечания
1. Директория data/ содержит обучающие, валидационные и тестовые наборы данных в формате .tsv.
2. Директория models/ хранит обученную модель машинного обучения.
4. Директория results/ содержит выходные файлы, включая метрики валидации, предсказания и объяснения.
5. При необходимости настройте алгоритм машинного обучения, гиперпараметры и инженерию признаков в скриптах.
